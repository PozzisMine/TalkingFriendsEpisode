<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Сериал — эпизоды</title>
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
  <div class="wrap">
    <a class="back" href="index.html">← Назад</a>
    <section id="show-info"></section>

    <h2>Эпизоды</h2>
    <ul id="episodes-list" class="episodes"></ul>

    <footer>
      <p>Редактируй <code>data/shows.json</code> для добавления эпизодов.</p>
    </footer>
  </div>

<script>
const params = new URLSearchParams(window.location.search);
const showId = params.get('id');

fetch('data/shows.json')
  .then(r => r.json())
  .then(shows => {
    const show = shows.find(s => s.id === showId);
    if (!show) {
      document.body.innerHTML = '<h1>Сериал не найден</h1>';
      return;
    }
    const info = document.getElementById('show-info');
    info.innerHTML = `
      <div class="show-head">
        <img class="poster large" src="${show.poster_url}" alt="${show.name}">
        <div>
          <h1>${show.name}</h1>
          <p class="desc">${show.description}</p>
        </div>
      </div>
    `;

    const eps = [...show.episodes].sort((a,b)=>a.number-b.number);
    const list = document.getElementById('episodes-list');
    list.innerHTML = eps.map(e => `
      <li>
        <a class="episode-link" href="episode.html?show=${show.id}&ep=${e.id}">
          <div class="ep-left">
            <strong>Серия ${e.number}</strong>
            <div class="ep-title">${e.title}</div>
            <small class="ep-date">${e.date}</small>
          </div>
          <div class="ep-right">→</div>
        </a>
      </li>
    `).join('');
  });
</script>
</body>
</html>
