<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Эпизод — Просмотр</title>
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
  <div class="wrap">
    <a class="back" id="back" href="index.html">← Назад</a>
    <div id="episode-container"></div>
  </div>

<script>
const params = new URLSearchParams(window.location.search);
const showId = params.get('show');
const epId = params.get('ep');

fetch('data/shows.json')
  .then(r => r.json())
  .then(shows => {
    const show = shows.find(s => s.id === showId);
    if (!show) { document.body.innerHTML = '<h1>Сериал не найден</h1>'; return; }
    const ep = show.episodes.find(e => e.id === epId);
    if (!ep) { document.body.innerHTML = '<h1>Эпизод не найден</h1>'; return; }

    document.getElementById('back').href = `show.html?id=${show.id}`;

    const cont = document.getElementById('episode-container');
    cont.innerHTML = `
      <div class="show-head small">
        <img class="poster large" src="${show.poster_url}" alt="${show.name}">
        <div>
          <h1>${show.name} — серия ${ep.number}: ${ep.title}</h1>
          <small class="ep-date">Дата: ${ep.date}</small>
          <p class="desc">${ep.description}</p>
        </div>
      </div>

      <div class="player-wrap">
        <iframe class="player" src="${ep.video_url}" frameborder="0" allowfullscreen></iframe>
      </div>
    `;
  });
</script>
</body>
</html>
